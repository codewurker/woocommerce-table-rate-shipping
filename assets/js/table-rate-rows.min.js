!function(a,i,e,o){var n=e.template("table-rate-shipping-row-template"),t=a("#mainform"),r=a("#shipping_rates"),s=r.find("tbody.table_rates"),p={init:function(){t.on("change","#woocommerce_table_rate_calculation_type",this.onCalculationTypeChange),r.on("change",'select[name^="shipping_condition"]',this.onShippingConditionChange).on("change",'input[name^="shipping_abort["]',this.onShippingAbortChange).on("click","a.add-rate",this.onAddRate).on("click","a.remove",this.onRemoveRate).on("click","a.dupe",this.onDupeRate);var i=s.data("rates");a(i).each(function(e){var t=s.find(".table_rate").length;s.append(n({rate:i[e],index:t}))}),a('label[for="woocommerce_table_rate_handling_fee"], label[for="woocommerce_table_rate_max_cost"], label[for="woocommerce_table_rate_min_cost"]',t).each(function(e,t){a(t).data("o_label",a(t).text())}),a('#woocommerce_table_rate_calculation_type, select[name^="shipping_condition"], input[name^="shipping_abort["]',t).change(),s.sortable({items:"tr",cursor:"move",axis:"y",handle:"td",scrollSensitivity:40,helper:function(e,t){return t.children().each(function(){a(this).width(a(this).width())}),t.css("left","0"),t},start:function(e,t){t.item.css("background-color","#f6f6f6")},stop:function(e,t){t.item.removeAttr("style"),p.reindexRows()}})},onCalculationTypeChange:function(){var e=a(this).val();"item"==e?a("td.cost_per_item input").attr("disabled","disabled").addClass("disabled"):a("td.cost_per_item input").removeAttr("disabled").removeClass("disabled"),e?(a("#shipping_class_priorities").hide(),a("td.shipping_label, th.shipping_label").hide()):(a("#shipping_class_priorities").show(),a("td.shipping_label, th.shipping_label").show()),e||(a("#shipping_class_priorities span.description.per_order").show(),a("#shipping_class_priorities span.description.per_class").hide());var n=i.i18n.order;"item"==e?n=i.i18n.item:"line"==e?n=i.i18n.line_item:"class"==e&&(n=i.i18n.class),a('label[for="woocommerce_table_rate_handling_fee"], label[for="woocommerce_table_rate_max_cost"], label[for="woocommerce_table_rate_min_cost"]').each(function(e,t){var i=a(t).data("o_label");i=i.replace("[item]",n),a(t).text(i)})},onShippingConditionChange:function(){var e=a(this).val(),t=a(this).closest("tr");""==e?t.find('input[name^="shipping_min"], input[name^="shipping_max"]').val("").prop("disabled",!0).addClass("disabled"):t.find('input[name^="shipping_min"], input[name^="shipping_max"]').prop("disabled",!1).removeClass("disabled")},onShippingAbortChange:function(){var e=a(this).is(":checked"),t=a(this).closest("tr");e?(t.find("td.cost").hide(),t.find("td.abort_reason").show(),t.find('input[name^="shipping_per_item"], input[name^="shipping_cost_per_weight"], input[name^="shipping_cost_percent"], input[name^="shipping_cost"], input[name^="shipping_label"]').prop("disabled",!0).addClass("disabled")):(t.find("td.cost").show(),t.find("td.abort_reason").hide(),t.find('input[name^="shipping_per_item"], input[name^="shipping_cost_per_weight"], input[name^="shipping_cost_percent"], input[name^="shipping_cost"], input[name^="shipping_label"]').prop("disabled",!1).removeClass("disabled")),a("#woocommerce_table_rate_calculation_type").change()},onAddRate:function(e){e.preventDefault();var t=s,i=t.find(".table_rate").length;t.append(n({rate:{rate_id:"",rate_class:"",rate_condition:"",rate_min:"",rate_max:"",rate_priority:"",rate_abort:"",rate_abort_reason:"",rate_cost:"",rate_cost_per_item:"",rate_cost_per_weight_unit:"",rate_cost_percent:"",rate_label:""},index:i})),a('#woocommerce_table_rate_calculation_type, select[name^="shipping_condition"], input[name^="shipping_abort["]',r).change()},onRemoveRate:function(e){if(e.preventDefault(),confirm(i.i18n.delete_rates)){var n=[];s.find("tr td.check-column input:checked").each(function(e,t){var i=a(t).closest("tr.table_rate").find(".rate_id").val();n.push(i),a(t).closest("tr.table_rate").addClass("deleting")});var t={action:"woocommerce_table_rate_delete",rate_id:n,security:i.delete_rates_nonce};a.post(o,t,function(e){a("tr.deleting").fadeOut("300",function(){a(this).remove()})})}},onDupeRate:function(e){e.preventDefault(),confirm(i.i18n.dupe_rates)&&(s.find("tr td.check-column input:checked").each(function(e,t){var i=a(t).closest("tr").clone();i.find(".rate_id").val("0"),s.append(i)}),p.reindexRows())},reindexRows:function(){var n=0;s.find("tr").each(function(e,t){a("input.text, input.checkbox, select.select, input[type=hidden]",t).each(function(e,t){var i=a(t);i.attr("name",i.attr("name").replace(/\[([^[]*)\]/,"["+n+"]"))}),n++})}};p.init()}(jQuery,woocommerce_shipping_table_rate_rows,wp,ajaxurl);
